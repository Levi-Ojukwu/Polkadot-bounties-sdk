import '@polkadot-api/substrate-client';
import { catchError } from 'rxjs';
import { BlockNotPinnedError } from '../chainHead/errors.mjs';
import '@polkadot-api/substrate-bindings';
import '../chainHead/validate-tx.mjs';

const withArchive = (chainHeadFn, archiveFn) => (blokHash, ...args) => chainHeadFn(blokHash, ...args).pipe(
  catchError((e) => {
    if (!(e instanceof BlockNotPinnedError)) throw e;
    return archiveFn(blokHash, ...args).pipe(
      catchError((actualErr) => {
        console.warn(actualErr);
        throw e;
      })
    );
  })
);

export { withArchive };
//# sourceMappingURL=with-archive.mjs.map
