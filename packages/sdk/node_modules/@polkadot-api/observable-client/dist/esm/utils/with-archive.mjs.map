{"version":3,"file":"with-archive.mjs","sources":["../../../src/utils/with-archive.ts"],"sourcesContent":["import { BlockNotPinnedError } from \"@/chainHead\"\nimport { catchError, Observable } from \"rxjs\"\n\nexport const withArchive =\n  <Args extends Array<any>, T, Hash extends string | (string | null)>(\n    chainHeadFn: (blockHash: Hash, ...args: Args) => Observable<T>,\n    archiveFn: (blockHash: string, ...args: Args) => Observable<T>,\n  ): ((blockHash: Hash, ...args: Args) => Observable<T>) =>\n  (blokHash, ...args) =>\n    chainHeadFn(blokHash, ...args).pipe(\n      catchError((e) => {\n        if (!(e instanceof BlockNotPinnedError)) throw e\n\n        return archiveFn(blokHash as string, ...args).pipe(\n          catchError((actualErr) => {\n            console.warn(actualErr)\n            throw e\n          }),\n        )\n      }),\n    )\n"],"names":[],"mappings":";;;;;;AAGO,MAAM,WAAA,GACX,CACE,WAAA,EACA,SAAA,KAEF,CAAC,QAAA,EAAA,GAAa,IAAA,KACZ,WAAA,CAAY,QAAA,EAAU,GAAG,IAAI,CAAA,CAAE,IAAA;AAAA,EAC7B,UAAA,CAAW,CAAC,CAAA,KAAM;AAChB,IAAA,IAAI,EAAE,CAAA,YAAa,mBAAA,CAAA,EAAsB,MAAM,CAAA;AAE/C,IAAA,OAAO,SAAA,CAAU,QAAA,EAAoB,GAAG,IAAI,CAAA,CAAE,IAAA;AAAA,MAC5C,UAAA,CAAW,CAAC,SAAA,KAAc;AACxB,QAAA,OAAA,CAAQ,KAAK,SAAS,CAAA;AACtB,QAAA,MAAM,CAAA;AAAA,MACR,CAAC;AAAA,KACH;AAAA,EACF,CAAC;AACH;;;;"}