import { compact } from '@polkadot-api/substrate-bindings';
import { fromHex, mergeUint8, toHex } from '@polkadot-api/utils';

const getFromShittyHeader = (hasher) => ({
  parentHash,
  number: rawNumber,
  stateRoot,
  extrinsicsRoot,
  digest
}) => {
  const number = Number(rawNumber);
  const rawDigests = digest.logs.map(fromHex);
  const rawHeader = mergeUint8([
    fromHex(parentHash),
    compact.enc(number),
    fromHex(stateRoot),
    fromHex(extrinsicsRoot),
    compact.enc(digest.logs.length),
    ...rawDigests
  ]);
  return {
    parent: parentHash,
    hash: toHex(hasher(rawHeader)),
    number,
    hasUpgrade: rawDigests.some(([x]) => x === 8),
    header: toHex(rawHeader)
  };
};

export { getFromShittyHeader };
//# sourceMappingURL=fromShittyHeader.mjs.map
