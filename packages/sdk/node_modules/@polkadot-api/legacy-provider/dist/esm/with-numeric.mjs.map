{"version":3,"file":"with-numeric.mjs","sources":["../../src/with-numeric.ts"],"sourcesContent":["import type { JsonRpcProvider } from \"@polkadot-api/json-rpc-provider\"\n\nexport const withNumericIds =\n  (base: JsonRpcProvider): JsonRpcProvider =>\n  (onMsg) => {\n    let nextId = 0\n    const numberToOriginal = new Map<number, string>()\n\n    const { send: originalSend, disconnect } = base((msg: string) => {\n      const { id, ...rest } = JSON.parse(msg)\n      let actualMsg = msg\n      if (numberToOriginal.has(id)) {\n        actualMsg = JSON.stringify({ ...rest, id: numberToOriginal.get(id) })\n        numberToOriginal.delete(id)\n      }\n      onMsg(actualMsg)\n    })\n\n    return {\n      send: (msg) => {\n        const parsedMsg = JSON.parse(msg)\n        let actualMsg = msg\n        if (\"id\" in parsedMsg) {\n          const id = nextId++\n          numberToOriginal.set(id, parsedMsg.id)\n          actualMsg = JSON.stringify({ ...parsedMsg, id })\n        }\n        originalSend(actualMsg)\n      },\n      disconnect,\n    }\n  }\n"],"names":[],"mappings":"AAEO,MAAM,cAAA,GACX,CAAC,IAAA,KACD,CAAC,KAAA,KAAU;AACT,EAAA,IAAI,MAAA,GAAS,CAAA;AACb,EAAA,MAAM,gBAAA,uBAAuB,GAAA,EAAoB;AAEjD,EAAA,MAAM,EAAE,IAAA,EAAM,YAAA,EAAc,YAAW,GAAI,IAAA,CAAK,CAAC,GAAA,KAAgB;AAC/D,IAAA,MAAM,EAAE,EAAA,EAAI,GAAG,MAAK,GAAI,IAAA,CAAK,MAAM,GAAG,CAAA;AACtC,IAAA,IAAI,SAAA,GAAY,GAAA;AAChB,IAAA,IAAI,gBAAA,CAAiB,GAAA,CAAI,EAAE,CAAA,EAAG;AAC5B,MAAA,SAAA,GAAY,IAAA,CAAK,SAAA,CAAU,EAAE,GAAG,IAAA,EAAM,IAAI,gBAAA,CAAiB,GAAA,CAAI,EAAE,CAAA,EAAG,CAAA;AACpE,MAAA,gBAAA,CAAiB,OAAO,EAAE,CAAA;AAAA,IAC5B;AACA,IAAA,KAAA,CAAM,SAAS,CAAA;AAAA,EACjB,CAAC,CAAA;AAED,EAAA,OAAO;AAAA,IACL,IAAA,EAAM,CAAC,GAAA,KAAQ;AACb,MAAA,MAAM,SAAA,GAAY,IAAA,CAAK,KAAA,CAAM,GAAG,CAAA;AAChC,MAAA,IAAI,SAAA,GAAY,GAAA;AAChB,MAAA,IAAI,QAAQ,SAAA,EAAW;AACrB,QAAA,MAAM,EAAA,GAAK,MAAA,EAAA;AACX,QAAA,gBAAA,CAAiB,GAAA,CAAI,EAAA,EAAI,SAAA,CAAU,EAAE,CAAA;AACrC,QAAA,SAAA,GAAY,KAAK,SAAA,CAAU,EAAE,GAAG,SAAA,EAAW,IAAI,CAAA;AAAA,MACjD;AACA,MAAA,YAAA,CAAa,SAAS,CAAA;AAAA,IACxB,CAAA;AAAA,IACA;AAAA,GACF;AACF;;;;"}