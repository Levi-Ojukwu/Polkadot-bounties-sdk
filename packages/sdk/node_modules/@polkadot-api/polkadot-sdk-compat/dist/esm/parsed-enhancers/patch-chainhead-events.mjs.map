{"version":3,"file":"patch-chainhead-events.mjs","sources":["../../../src/parsed-enhancers/patch-chainhead-events.ts"],"sourcesContent":["import type { ParsedJsonRpcEnhancer } from \"@/parsed\"\n\nexport const patchChainHeadEvents: ParsedJsonRpcEnhancer = (base) => (onMsg) =>\n  base((message) => {\n    const result = (message as any).params?.result\n    if (!(\"id\" in message) && result) {\n      const { prunedBlockHashes, finalizedBlockHash, event } = result\n      if (event === \"finalized\" && Array.isArray(prunedBlockHashes))\n        result.prunedBlockHashes = [...new Set(result.prunedBlockHashes)]\n      else if (event === \"initialized\" && finalizedBlockHash) {\n        result.finalizedBlockHashes = [result.finalizedBlockHash]\n        delete result.finalizedBlockHash\n      }\n    }\n    onMsg(message)\n  })\n"],"names":[],"mappings":"AAEO,MAAM,uBAA8C,CAAC,IAAA,KAAS,CAAC,KAAA,KACpE,IAAA,CAAK,CAAC,OAAA,KAAY;AAChB,EAAA,MAAM,MAAA,GAAU,QAAgB,MAAA,EAAQ,MAAA;AACxC,EAAA,IAAI,EAAE,IAAA,IAAQ,OAAA,CAAA,IAAY,MAAA,EAAQ;AAChC,IAAA,MAAM,EAAE,iBAAA,EAAmB,kBAAA,EAAoB,KAAA,EAAM,GAAI,MAAA;AACzD,IAAA,IAAI,KAAA,KAAU,WAAA,IAAe,KAAA,CAAM,OAAA,CAAQ,iBAAiB,CAAA;AAC1D,MAAA,MAAA,CAAO,oBAAoB,CAAC,GAAG,IAAI,GAAA,CAAI,MAAA,CAAO,iBAAiB,CAAC,CAAA;AAAA,SAAA,IACzD,KAAA,KAAU,iBAAiB,kBAAA,EAAoB;AACtD,MAAA,MAAA,CAAO,oBAAA,GAAuB,CAAC,MAAA,CAAO,kBAAkB,CAAA;AACxD,MAAA,OAAO,MAAA,CAAO,kBAAA;AAAA,IAChB;AAAA,EACF;AACA,EAAA,KAAA,CAAM,OAAO,CAAA;AACf,CAAC;;;;"}