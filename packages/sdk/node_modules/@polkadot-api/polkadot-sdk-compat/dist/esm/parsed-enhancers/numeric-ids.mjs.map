{"version":3,"file":"numeric-ids.mjs","sources":["../../../src/parsed-enhancers/numeric-ids.ts"],"sourcesContent":["import type { ParsedJsonRpcEnhancer } from \"@/parsed\"\n\nexport const withNumericIds: ParsedJsonRpcEnhancer = (base) => (onMsg) => {\n  let nextId = 0\n  const numberToOriginal = new Map<number, string>()\n\n  const { send: originalSend, disconnect } = base((message: any) => {\n    const { id } = message\n    if (numberToOriginal.has(id)) {\n      message.id = numberToOriginal.get(id)\n      numberToOriginal.delete(id)\n    }\n    onMsg(message)\n  })\n\n  return {\n    send: (msg: { id?: any }) => {\n      if (\"id\" in msg) {\n        numberToOriginal.set(nextId, msg.id)\n        msg.id = nextId++\n      }\n      originalSend(msg)\n    },\n    disconnect,\n  }\n}\n"],"names":[],"mappings":"AAEO,MAAM,cAAA,GAAwC,CAAC,IAAA,KAAS,CAAC,KAAA,KAAU;AACxE,EAAA,IAAI,MAAA,GAAS,CAAA;AACb,EAAA,MAAM,gBAAA,uBAAuB,GAAA,EAAoB;AAEjD,EAAA,MAAM,EAAE,IAAA,EAAM,YAAA,EAAc,YAAW,GAAI,IAAA,CAAK,CAAC,OAAA,KAAiB;AAChE,IAAA,MAAM,EAAE,IAAG,GAAI,OAAA;AACf,IAAA,IAAI,gBAAA,CAAiB,GAAA,CAAI,EAAE,CAAA,EAAG;AAC5B,MAAA,OAAA,CAAQ,EAAA,GAAK,gBAAA,CAAiB,GAAA,CAAI,EAAE,CAAA;AACpC,MAAA,gBAAA,CAAiB,OAAO,EAAE,CAAA;AAAA,IAC5B;AACA,IAAA,KAAA,CAAM,OAAO,CAAA;AAAA,EACf,CAAC,CAAA;AAED,EAAA,OAAO;AAAA,IACL,IAAA,EAAM,CAAC,GAAA,KAAsB;AAC3B,MAAA,IAAI,QAAQ,GAAA,EAAK;AACf,QAAA,gBAAA,CAAiB,GAAA,CAAI,MAAA,EAAQ,GAAA,CAAI,EAAE,CAAA;AACnC,QAAA,GAAA,CAAI,EAAA,GAAK,MAAA,EAAA;AAAA,MACX;AACA,MAAA,YAAA,CAAa,GAAG,CAAA;AAAA,IAClB,CAAA;AAAA,IACA;AAAA,GACF;AACF;;;;"}