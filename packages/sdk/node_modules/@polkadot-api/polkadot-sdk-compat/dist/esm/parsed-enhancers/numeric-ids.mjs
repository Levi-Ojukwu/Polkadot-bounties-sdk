const withNumericIds = (base) => (onMsg) => {
  let nextId = 0;
  const numberToOriginal = /* @__PURE__ */ new Map();
  const { send: originalSend, disconnect } = base((message) => {
    const { id } = message;
    if (numberToOriginal.has(id)) {
      message.id = numberToOriginal.get(id);
      numberToOriginal.delete(id);
    }
    onMsg(message);
  });
  return {
    send: (msg) => {
      if ("id" in msg) {
        numberToOriginal.set(nextId, msg.id);
        msg.id = nextId++;
      }
      originalSend(msg);
    },
    disconnect
  };
};

export { withNumericIds };
//# sourceMappingURL=numeric-ids.mjs.map
